const STAGES=Object.freeze({BREAK:"break",PREP:"prep",WAR:"war"}),PHASES=Object.freeze({PHASE1:1,PHASE2:2,PHASE3:3,PHASE4:4,PHASE5:5,PHASE6:6,NONE:0}),RESPAWN_TIMES=[1780,1760,1740,1720,1700,1680,1660,1640,1620,1600,1580,1560,1540,1520,1500,1492,1464,1436,1408,1380,1352,1324,1296,1268,1240,1212,1184,1148,1112,1076,1040,1004,968,932,896,860,816,772,728,684,640,596,552,500,448,396,344,292,232,172,112,52],TIME_BETWEEN_RESPAWNS=[20,28,36,44,52,60],PHASE_TIMES=[1500,1184,860,550,292,52],MODE1_STAGES={PREP_START:2700,PREP_END:3600,WAR_START:0,WAR_END:1800,BREAK_START:1800,BREAK_END:2700},MODE2_STAGES={PREP_START:900,PREP_END:1800,WAR_START:1800,WAR_END:3600,BREAK_START:0,BREAK_END:900},JUMP_ADJUSTMENT=8,NO_RESPAWNS_REMAINING="No respawns remaining";let mode=MODE1_STAGES,stage=STAGES.BREAK,phase=0,captureTimes=[],timeRem=0,respawnTime=0,timeToRespawn=0,jumpedRespawnTime=0,timetoJumpedRespawn=0,phaseTime=0,timeToPhase=0,respawnsRemaining=0,userAdjustment=parseInt(localStorage.getItem("userAdjustment"))||0,isJumped=!1,timeBetweenRespawn=0,volume=0,clock=null,fontSizeNormalRespawn=parseFloat(localStorage.getItem("fontSizeNormalRespawn"))||3,fontSizeJumpedRespawn=parseFloat(localStorage.getItem("fontSizeJumpedRespawn"))||3,fontSizeRespawnInterval=parseFloat(localStorage.getItem("fontSizeRespawnInterval"))||1;class SimulatedClock{constructor(e){this.startTime=e}now(){return this.startTime+++userAdjustment}}class RealClock{constructor(){}now(){var e=new Date;return 60*e.getMinutes()+e.getSeconds()+userAdjustment}}class ManualClock{constructor(){this.time=0}now(){return this.time+userAdjustment}forward(){this.time+=1}back(){--this.time}}function getCurrentTimeInSeconds(){return clock.now()}function getCurrentStage(e){return mode.PREP_START<=e&&e<mode.PREP_END?STAGES.PREP:mode.WAR_START<=e&&e<mode.WAR_END?STAGES.WAR:STAGES.BREAK}function getCurrentPhase(t){for(let e=0;e<PHASE_TIMES.length;e++)if(PHASE_TIMES[e]<t)return PHASES["PHASE"+(e+1)];return PHASES.PHASE6}function getPhaseTime(e){return e=getCurrentPhase(e),PHASE_TIMES[e-1]||0}function getTimeBetweenRespawns(e){return e<TIME_BETWEEN_RESPAWNS.length?TIME_BETWEEN_RESPAWNS[e-1]:0}function getTimeRemainingInStage(e,t){return t==STAGES.PREP?mode.PREP_END-e:t==STAGES.WAR?mode.WAR_END-e:t==STAGES.BREAK?mode.BREAK_END-e:void 0}function getNumberRespawnsRemainingInPhase(t){var e=getCurrentPhase(t)-1;if(-1==e)return 0;const n=PHASE_TIMES[e];return RESPAWN_TIMES.filter(e=>e<t&&e>=n).length}function getNextRespawnTime(t){for(let e=0;e<RESPAWN_TIMES.length;e++)if(RESPAWN_TIMES[e]<=t)return RESPAWN_TIMES[e];return-1}function getNextJumpedRespawnTime(e,t){var n=getNextRespawnTime(e);return t==PHASES.PHASE1||isLastRespawnInPhase(e,t)?n:timeRem-n>=JUMP_ADJUSTMENT?n+JUMP_ADJUSTMENT:getNextRespawnTime(n-1)+JUMP_ADJUSTMENT}function formatTime(e){return Math.floor(e/60)+":"+(e%60).toString().padStart(2,"0")}function formatAdjustmentTime(e){return(0<=e?"+":"-")+formatTime(Math.abs(e))}function capitalizeFirst(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}function updateAudioVolume(e){}function isLastRespawnInPhase(e,t){return getTimeBetweenRespawns(t),e-getPhaseTime(e)<=JUMP_ADJUSTMENT}const jumpedButton=document.getElementById("jumpButton"),altTimersCheck=document.getElementById("checkAltTimer"),volumeSlider=document.getElementById("volumeSlider"),nudgePlus=document.getElementById("adjustPlus"),nudgeMinus=document.getElementById("adjustMinus"),nudgeReset=document.getElementById("adjustReset"),muteButton=document.getElementById("muteButton"),saveButton=document.getElementById("saveButton"),openModalButton=document.getElementById("openModal");function OnJumpButtonClicked(){(isJumped=!isJumped)?(jumpedButton.textContent="Switch to Normal",respawnBoxElement.classList.add("disabled"),jumpedBoxElement.classList.remove("disabled")):(jumpedButton.textContent="Switch to Jumped",respawnBoxElement.classList.remove("disabled"),jumpedBoxElement.classList.add("disabled")),updateDisplay()}function OnAltTimerCheckClicked(){mode=altTimersCheck.checked?MODE2_STAGES:MODE1_STAGES}function OnVolumeSliderChanged(){volume=volumeSlider.value/100,beepAudio.volume=volume,(respawnAudio.volume=volume)<=.001?speakerIconElement.classList=SPEAKER_MUTE:volume<=.5?speakerIconElement.classList=SPEAKER_VOL_LOW:speakerIconElement.classList=SPEAKER_VOL_HIGH}function OnMuteButtonClicked(){volume=volume<=.001?.25:0,volumeSlider.value=100*volume,volumeSlider.dispatchEvent(new Event("input"))}function OnNudgeMinusClicked(){--userAdjustment,update()}function OnNudgePlusClicked(){userAdjustment+=1,update()}function OnNudgeResetClicked(){userAdjustment=0,update()}function OnWindowBeforeUnload(){localStorage.setItem("userAdjustment",userAdjustment),localStorage.setItem("fontSizeNormalRespawn",fontSizeNormalRespawn),localStorage.setItem("fontSizeJumpedRespawn",fontSizeJumpedRespawn),localStorage.setItem("fontSizeRespawnInterval",fontSizeRespawnInterval)}function OnWindowLoad(){updateFontSizes()}function OneTimeRemainingElementWheel(e){e.preventDefault(),e.deltaY<0?userAdjustment+=1:0<e.deltaY&&--userAdjustment,updateDisplay()}function OnSaveButtonClicked(){fontSizeNormalRespawn=parseFloat(document.getElementById("fontSizeNormalInput").value,3),fontSizeJumpedRespawn=parseFloat(document.getElementById("fontSizeJumpInput").value,3),fontSizeRespawnInterval=parseFloat(document.getElementById("fontSizeRespawnIntervalInput").value,1),updateFontSizes()}function OnOpenModalButtonClicked(){document.getElementById("fontSizeNormalInput").value=""+fontSizeNormalRespawn,document.getElementById("fontSizeJumpInput").value=""+fontSizeJumpedRespawn,document.getElementById("fontSizeRespawnIntervalInput").value=""+fontSizeRespawnInterval}function SetUpEventListeners(){jumpedButton.addEventListener("click",OnJumpButtonClicked),altTimersCheck.addEventListener("click",OnAltTimerCheckClicked),volumeSlider.addEventListener("input",OnVolumeSliderChanged),nudgeMinus.addEventListener("click",OnNudgeMinusClicked),nudgePlus.addEventListener("click",OnNudgePlusClicked),nudgeReset.addEventListener("click",OnNudgeResetClicked),muteButton.addEventListener("click",OnMuteButtonClicked),window.addEventListener("beforeunload",OnWindowBeforeUnload),window.addEventListener("DOMContentLoaded",OnWindowLoad),timeRemainingElement.addEventListener("wheel",OneTimeRemainingElementWheel),saveButton.addEventListener("click",OnSaveButtonClicked),openModalButton.addEventListener("click",OnOpenModalButtonClicked)}const stageElement=document.getElementById("stage"),phaseElement=document.getElementById("phase"),timeRemainingElement=document.getElementById("timeRemaining"),nextPhaseTimeElement=document.getElementById("nextPhaseTime"),timeToPhaseElement=document.getElementById("timeToPhase"),nextRespawnTimeElement=document.getElementById("nextRespawnTime"),timeToRespawnElement=document.getElementById("timeToRespawn"),nextJumpedRespawnTimeElement=document.getElementById("nextJumpedRespawn"),timeToJumpRespawnElement=document.getElementById("timeToRespawnJumped"),countRespawnsElement=document.getElementById("countRespawns"),respawnBoxElement=document.getElementById("respawnBox"),jumpedBoxElement=document.getElementById("jumpedBox"),timeBetweenRespawnElement=document.getElementById("timeBetweenRespawn"),nudgeElement=document.getElementById("nudge"),beepAudio=document.getElementById("beep"),respawnAudio=document.getElementById("respawn"),speakerIconElement=document.getElementById("speakerIcon"),arrowLeft=document.getElementById("arrowLeft"),arrowRight=document.getElementById("arrowRight"),SPEAKER_MUTE="bi bi-volume-mute",SPEAKER_VOL_HIGH="bi bi-volume-up",SPEAKER_VOL_LOW="bi bi-volume-down",ARROW_LEFT="bi bi-arrow-left arrow",ARROW_RIGHT="bi bi-arrow-right arrow";function updatePhase(e){var t=getCurrentPhase(e);isJumped&&t!=phase&&jumpedButton.click(),phase=t,phaseTime=getPhaseTime(e),timeToPhase=timeRem-phaseTime}function updateRespawn(e){respawnTime=getNextRespawnTime(timeRem),timeToRespawn=0<respawnTime?timeRem-respawnTime:-1,jumpedRespawnTime=getNextJumpedRespawnTime(timeRem,phase),timetoJumpedRespawn=Math.max(timeRem-jumpedRespawnTime,0),respawnsRemaining=getNumberRespawnsRemainingInPhase(timeRem),timeBetweenRespawn=getTimeBetweenRespawns(phase)}function updateModel(){var e=getCurrentTimeInSeconds();stage=getCurrentStage(e),updatePhase(timeRem=getTimeRemainingInStage(e,stage)),updateRespawn(timeRem)}function updateArrows(){isJumped?(arrowLeft.classList="",arrowRight.classList=ARROW_RIGHT):(arrowLeft.classList=ARROW_LEFT,arrowRight.classList="")}function updateDisplay(){stageElement.textContent=""+capitalizeFirst(stage),timeRemainingElement.textContent=""+formatTime(timeRem),nudgeElement.textContent=""+formatAdjustmentTime(userAdjustment),(stage==STAGES.WAR?(phaseElement.textContent=`Phase ${phase} of `+PHASE_TIMES.length,0<timeToPhase?(nextPhaseTimeElement.textContent=""+formatTime(phaseTime),timeToPhaseElement.textContent=""+formatTime(timeToPhase)):(nextPhaseTimeElement.textContent=""+formatTime(0),timeToPhaseElement.textContent=""+formatTime(0)),0<respawnTime?(nextRespawnTimeElement.textContent=""+formatTime(respawnTime),timeToRespawnElement.textContent=""+formatTime(timeToRespawn),nextJumpedRespawnTimeElement.textContent=""+formatTime(jumpedRespawnTime),timeToJumpRespawnElement.textContent=""+formatTime(timetoJumpedRespawn)):(nextRespawnTimeElement.textContent=NO_RESPAWNS_REMAINING,timeToRespawnElement.textContent="0:00",nextJumpedRespawnTimeElement.textContent=NO_RESPAWNS_REMAINING,timeToJumpRespawnElement.textContent="0:00"),countRespawnsElement.textContent=""+respawnsRemaining,isJumped?(respawnBoxElement.classList.add("disabled"),jumpedBoxElement.classList.remove("disabled"),0<timetoJumpedRespawn&&timetoJumpedRespawn<=3?beepAudio.play():0==timetoJumpedRespawn&&respawnAudio.play()):(respawnBoxElement.classList.remove("disabled"),jumpedBoxElement.classList.add("disabled"),0<timeToRespawn&&timeToRespawn<=3?beepAudio.play():0==timeToRespawn&&respawnAudio.play()),updateArrows(),0<timeBetweenRespawn?timeBetweenRespawnElement.textContent=timeBetweenRespawn+"s":timeBetweenRespawnElement.textContent="",showControl(phaseElement),showControl(nextPhaseTimeElement),showControl(timeToPhaseElement),showControl(nextRespawnTimeElement),showControl(timeToRespawnElement),showControl(nextJumpedRespawnTimeElement),showControl(countRespawnsElement),showControl(timeToJumpRespawnElement),showControl(timeBetweenRespawnElement),showControl(arrowLeft),showControl(arrowRight),showControl):(hideControl(phaseElement),hideControl(nextPhaseTimeElement),hideControl(timeToPhaseElement),hideControl(nextRespawnTimeElement),hideControl(timeToRespawnElement),hideControl(nextJumpedRespawnTimeElement),hideControl(countRespawnsElement),hideControl(timeToJumpRespawnElement),hideControl(timeBetweenRespawnElement),hideControl(arrowLeft),hideControl(arrowRight),hideControl))(jumpedButton)}function disableControls(){nudgeMinus.classList.add("disabled"),nudgePlus.classList.add("disabled"),nudgeReset.classList.add("disabled"),jumpedButton.classList.add("disababled")}function enableControls(){nudgeMinus.classList.remove("disabled"),nudgePlus.classList.remove("disabled"),nudgeReset.classList.remove("disabled"),jumpedButton.classList.remove("disababled")}function hideControl(e){e.classList.add("invisible")}function showControl(e){e.classList.remove("invisible")}function update(){updateModel(),updateDisplay()}function updateFontSizes(){timeToRespawnElement.style.fontSize=fontSizeNormalRespawn+"rem",timeToJumpRespawnElement.style.fontSize=fontSizeJumpedRespawn+"rem",timeBetweenRespawnElement.style.fontSize=fontSizeRespawnInterval+"rem"}clock=new RealClock,beepAudio.volume=volume,respawnAudio.volume=volume,speakerIconElement.classList=SPEAKER_MUTE,SetUpEventListeners(),setInterval(update,1e3),update();
